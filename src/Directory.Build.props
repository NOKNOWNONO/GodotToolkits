<Project>
	<Import Project="$(MSBuildThisFileDirectory)/../Directory.Build.props" />
	<PropertyGroup>
		<Nullable>enable</Nullable>
		<LangVersion>latest</LangVersion>
		<IsPackable>true</IsPackable>
		<GeneratePackageOnBuild Condition="'$(DesignTimeBuild)' != 'true'"
			>true</GeneratePackageOnBuild
		>
		<IncludeBuildOutput>false</IncludeBuildOutput>
		<PackageId>$(RootNamespace)</PackageId>
		<Title>$(RootNamespace)</Title>
		<Authors>NOKNOWNONO</Authors>
		<Product>$(RootNamespace)</Product>
		<RepositoryType>git</RepositoryType>
		<PackageLicenseExpression>MIT</PackageLicenseExpression>
		<PackageReadmeFile>README.md</PackageReadmeFile>
		<RepositoryUrl>https://github.com/NOKNOWNONO/GodotToolkits.git</RepositoryUrl>
		<PackageProjectUrl>https://github.com/NOKNOWNONO/GodotToolkits</PackageProjectUrl>
		<PackageIcon>icon.png</PackageIcon>
		<Copyright>Copyright NOKNOWNONO. All rights reserved</Copyright>
	</PropertyGroup>
	<ItemGroup>
		<Compile Include="$(MSBuildThisFileDirectory)/Utils/*.cs">
			<Link>ProjectInfo.cs</Link>
			<Link>AttributeStringBuild.cs</Link>
			<Link>SyntaxNodeExtensions.cs</Link>
		</Compile>
	</ItemGroup>
	<ItemGroup>
		<None Include="$(MSBuildProjectDirectory)/README.md" Pack="true" PackagePath="/" />
		<None
			Include="$(MSBuildProjectDirectory)/../../icon.png"
			Pack="true"
			PackagePath="/"
			Visible="false"
		/>
	</ItemGroup>
	<ItemGroup>
		<!-- 明确告诉MSBuild这个文件是在编译过程中生成的 -->
		<Content
			Include="$(OutputPath)\$(AssemblyName).dll"
			Pack="true"
			PackagePath="analyzers/dotnet/cs"
		>
			<Visible>false</Visible>
			<!-- 关键：指定这个文件是构建输出 -->
			<Link>analyzers/dotnet/cs/$(AssemblyName).dll</Link>
		</Content>
	</ItemGroup>
	<!-- 确保在编译之后处理打包 -->
	<Target Name="IncludeAnalyzersInPackage" AfterTargets="Build">
		<ItemGroup>
			<Content
				Include="$(OutputPath)\$(AssemblyName).dll"
				Pack="true"
				PackagePath="analyzers/dotnet/cs"
			/>
			<!-- 如果有依赖，也在这里包含 -->
			<Content
				Include="$(OutputPath)\*.dll"
				Pack="true"
				PackagePath="analyzers/dotnet/cs"
				Condition="'%(Filename)' != '$(AssemblyName)'"
			/>
		</ItemGroup>
	</Target>
</Project>
